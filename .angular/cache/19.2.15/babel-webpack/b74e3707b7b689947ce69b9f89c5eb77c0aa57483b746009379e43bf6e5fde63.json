{"ast":null,"code":"import _asyncToGenerator from \"/Users/vlarix/Documents/mobile-apps/rsvp-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/app/services/supabase/supabase-api.service\";\nimport * as i3 from \"src/app/services/global-services/global-services\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@ionic/angular\";\nfunction SignupPage_ion_text_12_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-text\", 14)(1, \"p\", 15);\n    i0.ɵɵtext(2, \"Name is required\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction SignupPage_ion_text_17_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 15);\n    i0.ɵɵtext(1, \"Email is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SignupPage_ion_text_17_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 15);\n    i0.ɵɵtext(1, \"Enter a valid email\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SignupPage_ion_text_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-text\", 14);\n    i0.ɵɵtemplate(1, SignupPage_ion_text_17_p_1_Template, 2, 0, \"p\", 16)(2, SignupPage_ion_text_17_p_2_Template, 2, 0, \"p\", 16);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.signupForm.controls[\"email\"].hasError(\"required\"));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.signupForm.controls[\"email\"].hasError(\"email\"));\n  }\n}\nfunction SignupPage_ion_text_22_p_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 15);\n    i0.ɵɵtext(1, \"Password is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SignupPage_ion_text_22_p_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 15);\n    i0.ɵɵtext(1, \"Min 6 characters \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction SignupPage_ion_text_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-text\", 14);\n    i0.ɵɵtemplate(1, SignupPage_ion_text_22_p_1_Template, 2, 0, \"p\", 16)(2, SignupPage_ion_text_22_p_2_Template, 2, 0, \"p\", 16);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.signupForm.controls[\"password\"].hasError(\"required\"));\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.signupForm.controls[\"password\"].hasError(\"minlength\"));\n  }\n}\nfunction SignupPage_ion_text_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"ion-text\", 14)(1, \"p\", 15);\n    i0.ɵɵtext(2, \"Passwords do not match\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport let SignupPage = /*#__PURE__*/(() => {\n  var _SignupPage;\n  class SignupPage {\n    constructor(fb, api, globalServices, router) {\n      this.fb = fb;\n      this.api = api;\n      this.globalServices = globalServices;\n      this.router = router;\n      this.passwordMismatch = false;\n      this.bDisableButton = false;\n      this.signupForm = this.fb.group({\n        name: ['', Validators.required],\n        email: ['', [Validators.required, Validators.email]],\n        password: ['', [Validators.required, Validators.minLength(6)]],\n        confirmPassword: ['', Validators.required]\n      });\n    }\n    isTouched(field) {\n      return this.signupForm.controls[field].touched || this.signupForm.controls[field].dirty;\n    }\n    onSubmit() {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const {\n          password,\n          confirmPassword\n        } = _this.signupForm.value;\n        _this.passwordMismatch = password !== confirmPassword;\n        _this.bDisableButton = true;\n        //If invalid shows all the error\n        if (_this.signupForm.invalid || _this.passwordMismatch) {\n          _this.bDisableButton = false;\n          _this.markFormTouched();\n          return;\n        }\n        console.log('Sign up successful:', _this.signupForm.value);\n        const {\n          data,\n          error\n        } = yield _this.api.signupWithEmail(_this.signupForm.value);\n        if (error) {\n          var _error$message;\n          yield _this.globalServices.presentToast((_error$message = error === null || error === void 0 ? void 0 : error.message) !== null && _error$message !== void 0 ? _error$message : 'Error on server', \"danger\", 'alert-circle-outline');\n          _this.bDisableButton = false;\n          return;\n        }\n        if (data) {\n          yield _this.globalServices.presentToast('Success sign up', \"success\", 'checkmark-circle-outline');\n          _this.bDisableButton = false;\n          _this.router.navigate(['verify-email']);\n        }\n      })();\n    }\n    markFormTouched() {\n      Object.values(this.signupForm.controls).forEach(control => {\n        control.markAsTouched();\n      });\n    }\n  }\n  _SignupPage = SignupPage;\n  _SignupPage.ɵfac = function SignupPage_Factory(__ngFactoryType__) {\n    return new (__ngFactoryType__ || _SignupPage)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.SupaBaseApiService), i0.ɵɵdirectiveInject(i3.GlobalServices), i0.ɵɵdirectiveInject(i4.Router));\n  };\n  _SignupPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: _SignupPage,\n    selectors: [[\"app-signup\"]],\n    standalone: false,\n    decls: 35,\n    vars: 7,\n    consts: [[1, \"ion-padding\", \"signup-background\"], [1, \"signup-container\"], [1, \"signup-card\"], [1, \"ion-text-center\"], [3, \"ngSubmit\", \"formGroup\"], [\"position\", \"floating\"], [\"type\", \"text\", \"formControlName\", \"name\", \"required\", \"\"], [\"color\", \"danger\", 4, \"ngIf\"], [\"type\", \"email\", \"formControlName\", \"email\", \"required\", \"\"], [\"type\", \"password\", \"formControlName\", \"password\", \"required\", \"\"], [\"type\", \"password\", \"formControlName\", \"confirmPassword\", \"required\", \"\"], [\"expand\", \"block\", \"type\", \"submit\", 1, \"ion-margin-top\", 3, \"disabled\"], [1, \"ion-text-center\", \"ion-margin-top\"], [\"routerLink\", \"/login\"], [\"color\", \"danger\"], [1, \"ion-padding-start\"], [\"class\", \"ion-padding-start\", 4, \"ngIf\"]],\n    template: function SignupPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-content\", 0)(1, \"div\", 1)(2, \"ion-card\", 2)(3, \"ion-card-header\")(4, \"ion-card-title\", 3);\n        i0.ɵɵtext(5, \"Sign Up\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(6, \"ion-card-content\")(7, \"form\", 4);\n        i0.ɵɵlistener(\"ngSubmit\", function SignupPage_Template_form_ngSubmit_7_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵelementStart(8, \"ion-item\")(9, \"ion-label\", 5);\n        i0.ɵɵtext(10, \"Full Name\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(11, \"ion-input\", 6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(12, SignupPage_ion_text_12_Template, 3, 0, \"ion-text\", 7);\n        i0.ɵɵelementStart(13, \"ion-item\")(14, \"ion-label\", 5);\n        i0.ɵɵtext(15, \"Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(16, \"ion-input\", 8);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(17, SignupPage_ion_text_17_Template, 3, 2, \"ion-text\", 7);\n        i0.ɵɵelementStart(18, \"ion-item\")(19, \"ion-label\", 5);\n        i0.ɵɵtext(20, \"Password\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(21, \"ion-input\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(22, SignupPage_ion_text_22_Template, 3, 2, \"ion-text\", 7);\n        i0.ɵɵelementStart(23, \"ion-item\")(24, \"ion-label\", 5);\n        i0.ɵɵtext(25, \"Confirm Password\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(26, \"ion-input\", 10);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(27, SignupPage_ion_text_27_Template, 3, 0, \"ion-text\", 7);\n        i0.ɵɵelementStart(28, \"ion-button\", 11);\n        i0.ɵɵtext(29);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(30, \"div\", 12)(31, \"small\");\n        i0.ɵɵtext(32, \" Already have an account? \");\n        i0.ɵɵelementStart(33, \"a\", 13);\n        i0.ɵɵtext(34, \"Log in\");\n        i0.ɵɵelementEnd()()()()()()();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(7);\n        i0.ɵɵproperty(\"formGroup\", ctx.signupForm);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.isTouched(\"name\") && ctx.signupForm.controls[\"name\"].hasError(\"required\"));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.isTouched(\"email\"));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.isTouched(\"password\"));\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngIf\", ctx.passwordMismatch);\n        i0.ɵɵadvance();\n        i0.ɵɵproperty(\"disabled\", ctx.bDisableButton);\n        i0.ɵɵadvance();\n        i0.ɵɵtextInterpolate1(\" \", ctx.bDisableButton ? \"Creating account...\" : \"Create Account\", \" \");\n      }\n    },\n    dependencies: [i5.NgIf, i1.ɵNgNoValidate, i1.NgControlStatus, i1.NgControlStatusGroup, i1.RequiredValidator, i6.IonButton, i6.IonCard, i6.IonCardContent, i6.IonCardHeader, i6.IonCardTitle, i6.IonContent, i6.IonInput, i6.IonItem, i6.IonLabel, i6.IonText, i6.TextValueAccessor, i6.RouterLinkWithHrefDelegate, i4.RouterLink, i1.FormGroupDirective, i1.FormControlName],\n    encapsulation: 2\n  });\n  return SignupPage;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}